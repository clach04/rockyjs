<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Simple Example</title>

    <!-- build:template
    <script src="../../<%= rockyjs_path %>"></script>
    /build -->
    <!-- build:remove -->
    <!-- this template/remove construct is a workaround as processhtml doesn't support variables for values -->
    <script src="../../src/html-binding.js"></script>
    <script src="../../src/symbols-manual.js"></script>
    <script src="../../src/symbols-generated.js"></script>
    <script src="../../src/transpiled.js"></script>
    <!-- /build -->


    <script src="jquery-1.7.1.min.js"></script>
    <script src="mustache.min.js"></script>

    <script src="https://raw.githubusercontent.com/alexei/sprintf.js/master/dist/sprintf.min.js"></script>

    <script src="https://raw.githubusercontent.com/samsonjs/strftime/master/strftime-min.js"></script>

    <link rel="stylesheet" href="https://highlightjs.org/static/demo/style.css">
    <link rel="stylesheet" title="Default" href="https://highlightjs.org/static/demo/styles/default.css">
    <script src="https://highlightjs.org/static/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- build:css ../../css/bootstrap.min.css -->
    <link href="../../html/css/bootstrap.min.css" rel="stylesheet">
    <!-- /build -->
    <!-- build:css ../../css/style.css -->
    <link href="../../html/css/style.css" rel="stylesheet">
    <!-- /build -->

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link rel="stylesheet" href="../common/css/style.css">
</head>
<body>
<div class="container">
    <div class="page-header">
        <h1>Text Example</h1>
        <p class="lead">
            This example demostrates the APIs around text rendering and fonts.
        </p>
    </div>

    <div class="col-md-6">
    <!
        <canvas id="pebble" class="rocky" width="432" height="504"></canvas>
    -->
        <canvas id="pebble" class="rocky" width="144" height="168"></canvas>
    </div>

    <div class="col-md-6">
        <h2>What's going on?</h2>
        <p>
            Similar to the <a href="../simple">simple example</a> it binds Rocky.js to a canvas, and update the output at a regular interval.
        </p>
        <p>
            This example uses <code>fonts_get_system_font()</code> to load one of Pebble's system fonts,
            as well as <code>fonts_load_custom_font()</code> and <code>fonts_load_custom_font_with_data()</code> to load custom fonts.
            Read more about <a href="https://developer.pebble.com/guides/pebble-apps/resources/font-resources/#font-compatibility-note">custom fonts at the developer documentation page</a>.
        </p>
    </div>

<div id="sampleArea"></div>

<!-- 
# Python template generator

name_list = [
    'FONT_SYSTEM_NAME',
    'FONT_NAME',
    'DEFAULT_BACKGROUND_COLOR',
    'DEFAULT_TIME_COLOR',
    '',

    'CLOCK_POS',
    'TIME_ALIGN',
    '',

    'BG_IMAGE',
    'IMAGE_RES_X',
    'IMAGE_RES_Y',
    'BG_IMAGE_GRECT',
    '',

    'NO_DATE',
    'FONT_DATE_SYSTEM_NAME',
    'DATE_ALIGN',
    'DATE_POS',
    'DATE_FMT_STR',
    '',

    'NO_BATTERY',
    'FONT_BAT_SYSTEM_NAME',
    'BAT_ALIGN',
    'BAT_POS',
    'BAT_FMT_STR',
    'DRAW_BATTERY',
    'DRAW_SMALL_BATTERY',
    '',

    'BT_POS',
    'BT_DISCONNECT_IMAGE_GRECT',
    'FONT_BT_SYSTEM_NAME',
    'BT_ALIGN',
    'BLUETOOTH_DISCONNECTED_STR',
    '',

    'USE_HEALTH',
    'HEALTH_POS',
    'HEALTH_ALIGN',
    '',
]


# template setup
dumb_template_pos = """    #define *name* GRect({{*name*.x}}, {{*name*.y}}, {{*name*.w}}, {{*name*.h}})"""
dumb_template_def = """    #define *name* {{*name*}}"""
for n in name_list:
    if not n:
        print ''
    else:
        if 'POS' in n or 'RECT' in n:
            print dumb_template_pos.replace('*name*', n)
        else:
            print dumb_template_def.replace('*name*', n)

print ''
print ''

# dict setup
dumb_template = """    *name*: *name*,"""
for n in name_list:
    if not n:
        print ''
    else:
        print dumb_template.replace('*name*', n)


-->

<!--  TODO syntax highlighting? -->
<script id="template" type="x-tmpl-mustache">
<pre><code class="cpp">
/* watch_config.h suitable for use with https://github.com/clach04/watchface_framework/ */

#ifndef PBL_ROUND /* I.e. PBL_RECT 144x168 */
    #define FONT_SYSTEM_NAME {{FONT_SYSTEM_NAME}}  // NOTE could use default
    #define FONT_NAME RESOURCE_ID_FONT_...._{{FONT_SIZE}}  // {{FONT_NAME}}
    #define DEFAULT_BACKGROUND_COLOR {{DEFAULT_BACKGROUND_COLOR}}  // NOTE could use default FIXME don't use numeric literals use GColorBlack, etc.
    #define DEFAULT_TIME_COLOR {{DEFAULT_TIME_COLOR}}  // NOTE could use default FIXME don't use numeric literals use GColorWhite, etc.

    #define CLOCK_POS GRect({{CLOCK_POS.x}}, {{CLOCK_POS.y}}, {{CLOCK_POS.w}}, {{CLOCK_POS.h}})
    #define TIME_ALIGN {{TIME_ALIGN}}  // FIXME don't use numeric literals, instead use GTextAlignmentCenter, GTextAlignmentLeft, GTextAlignmentRight

    {{#BG_IMAGE}}
    #define BG_IMAGE RESOURCE_ID_..... "{{BG_IMAGE}}"
    {{/BG_IMAGE}}
    {{^BG_IMAGE}}
    //#define BG_IMAGE RESOURCE_ID_.....
    {{/BG_IMAGE}}
    // Setting X and Y to image res allows quick math for centering, etc.
    #define IMAGE_RES_X {{IMAGE_RES_X}}
    #define IMAGE_RES_Y {{IMAGE_RES_Y}}
    //#define BG_IMAGE_GRECT GRect((144 - IMAGE_RES_X) / 2, 0,  IMAGE_RES_X, IMAGE_RES_Y)  // use same size as image, centered horizontally on screen. On Aplite can determine this at runtime but not Basalt
    #define BG_IMAGE_GRECT GRect({{BG_IMAGE_GRECT.x}}, {{BG_IMAGE_GRECT.y}}, {{BG_IMAGE_GRECT.w}}, {{BG_IMAGE_GRECT.h}})

    {{#NO_DATE}}
    #define NO_DATE
    {{/NO_DATE}}
    {{^NO_DATE}}
    #undef NO_DATE
    {{/NO_DATE}}
    #define FONT_DATE_SYSTEM_NAME {{FONT_DATE_SYSTEM_NAME}}
    #define DATE_ALIGN {{DATE_ALIGN}}  // FIXME don't use numeric literals, instead use GTextAlignmentCenter, GTextAlignmentLeft, GTextAlignmentRight
    #define DATE_POS GRect({{DATE_POS.x}}, {{DATE_POS.y}}, {{DATE_POS.w}}, {{DATE_POS.h}})
    #define DATE_FMT_STR "{{DATE_FMT_STR}}"  // NOTE could use default

    {{#NO_BATTERY}}
    #define NO_BATTERY
    {{/NO_BATTERY}}
    {{^NO_BATTERY}}
    #undef NO_BATTERY
    {{/NO_BATTERY}}
    #define FONT_BAT_SYSTEM_NAME {{FONT_BAT_SYSTEM_NAME}}  // NOTE could use default
    #define BAT_ALIGN {{BAT_ALIGN}}  // FIXME don't use numeric literals, instead use GTextAlignmentCenter, GTextAlignmentLeft, GTextAlignmentRight
    #define BAT_POS GRect({{BAT_POS.x}}, {{BAT_POS.y}}, {{BAT_POS.w}}, {{BAT_POS.h}})
    #define BAT_FMT_STR "{{BAT_FMT_STR}}"  // NOTE could use default
    {{#DRAW_BATTERY}}
    #define DRAW_BATTERY
    {{/DRAW_BATTERY}}
    {{^DRAW_BATTERY}}
    #undef DRAW_BATTERY
    {{/DRAW_BATTERY}}
    {{#DRAW_SMALL_BATTERY}}
    #define DRAW_SMALL_BATTERY
    {{/DRAW_SMALL_BATTERY}}
    {{^DRAW_SMALL_BATTERY}}
    #undef DRAW_SMALL_BATTERY
    {{/DRAW_SMALL_BATTERY}}

    #define BT_POS GRect({{BT_POS.x}}, {{BT_POS.y}}, {{BT_POS.w}}, {{BT_POS.h}})
    #define BT_DISCONNECT_IMAGE_GRECT GRect({{BT_DISCONNECT_IMAGE_GRECT.x}}, {{BT_DISCONNECT_IMAGE_GRECT.y}}, {{BT_DISCONNECT_IMAGE_GRECT.w}}, {{BT_DISCONNECT_IMAGE_GRECT.h}})
    #define FONT_BT_SYSTEM_NAME {{FONT_BT_SYSTEM_NAME}}
    #define BT_ALIGN {{BT_ALIGN}}  // FIXME don't use numeric literals, instead use GTextAlignmentCenter, GTextAlignmentLeft, GTextAlignmentRight
    #define BLUETOOTH_DISCONNECTED_STR "{{BLUETOOTH_DISCONNECTED_STR}}" // NOTE could use default

    {{#USE_HEALTH}}
    #define USE_HEALTH
    {{/USE_HEALTH}}
    {{^USE_HEALTH}}
    #undef USE_HEALTH
    {{/USE_HEALTH}}
    #define HEALTH_POS GRect({{HEALTH_POS.x}}, {{HEALTH_POS.y}}, {{HEALTH_POS.w}}, {{HEALTH_POS.h}})
    #define HEALTH_ALIGN {{HEALTH_ALIGN}}  // FIXME don't use numeric literals, instead use GTextAlignmentCenter, GTextAlignmentLeft, GTextAlignmentRight
#endif /* PBL_ROUND  */
</code></pre>
</script>

    <!-- build:template
    <%= github_banner %>
    /build -->
</div>
</body>

<script>
    (function () {

        /*
        ** Example:
        **      time_str = _format('{0}:{1}', [current_datetime.getHours(), current_datetime.getMinutes()]);
        */
        function _format (str, arr) {
            return str.replace(/{(\d+)}/g, function (match, number) {
                return typeof arr[number] != 'undefined' ? arr[number] : match;
            });
        };

        var rocky = Rocky.bindCanvas(document.getElementById("pebble"));
        // puts all C-symbols from rocky onto window.* so they can be used almost
        // the same way you were using them in C
        rocky.export_global_c_symbols();

        var peb_color_dict = {
            0xC0: "GColorBlack",
            0xC1: "GColorOxfordBlue",
            0xC2: "GColorDukeBlue",
            0xC3: "GColorBlue",
            0xC4: "GColorDarkGreen",
            0xC5: "GColorMidnightGreen",
            0xC6: "GColorCobaltBlue",
            0xC7: "GColorBlueMoon",
            0xC8: "GColorIslamicGreen",
            0xC9: "GColorJaegerGreen",
            0xCA: "GColorTiffanyBlue",
            0xCB: "GColorVividCerulean",
            0xCC: "GColorGreen",
            0xCD: "GColorMalachite",
            0xCE: "GColorMediumSpringGreen",
            0xCF: "GColorCyan",
            0xD0: "GColorBulgarianRose",
            0xD1: "GColorImperialPurple",
            0xD2: "GColorIndigo",
            0xD3: "GColorElectricUltramarine",
            0xD4: "GColorArmyGreen",
            0xD5: "GColorDarkGray",
            0xD6: "GColorLiberty",
            0xD7: "GColorVeryLightBlue",
            0xD8: "GColorKellyGreen",
            0xD9: "GColorMayGreen",
            0xDA: "GColorCadetBlue",
            0xDB: "GColorPictonBlue",
            0xDC: "GColorBrightGreen",
            0xDD: "GColorScreaminGreen",
            0xDE: "GColorMediumAquamarine",
            0xDF: "GColorElectricBlue",
            0xE0: "GColorDarkCandyAppleRed",
            0xE1: "GColorJazzberryJam",
            0xE2: "GColorPurple",
            0xE3: "GColorVividViolet",
            0xE4: "GColorWindsorTan",
            0xE5: "GColorRoseVale",
            0xE6: "GColorPurpureus",
            0xE7: "GColorLavenderIndigo",
            0xE8: "GColorLimerick",
            0xE9: "GColorBrass",
            0xEA: "GColorLightGray",
            0xEB: "GColorBabyBlueEyes",
            0xEC: "GColorSpringBud",
            0xED: "GColorInchworm",
            0xEE: "GColorMintGreen",
            0xEF: "GColorCeleste",
            0xF0: "GColorRed",
            0xF1: "GColorFolly",
            0xF2: "GColorFashionMagenta",
            0xF3: "GColorMagenta",
            0xF4: "GColorOrange",
            0xF5: "GColorSunsetOrange",
            0xF6: "GColorBrilliantRose",
            0xF7: "GColorShockingPink",
            0xF8: "GColorChromeYellow",
            0xF9: "GColorRajah",
            0xFA: "GColorMelon",
            0xFB: "GColorRichBrilliantLavender",
            0xFC: "GColorYellow",
            0xFD: "GColorIcterine",
            0xFE: "GColorPastelYellow",
            0xFF: "GColorWhite"
        };

        // OSP-DIN at 10pt taken from https://github.com/pebble-examples/feature-custom-font
        var fontData = atob("AxCNAK8l/wIKAQAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAEAACEBBAAiAQgAIwAMACQADAAlAQwAJgAQACcBEAAoARQAKQEYACoAHAArARwALAEgAC0BJAAuASgALwEsADABMAAxATQAMgE4ADMBPAA0AUAANQFEADYBSAA3AUwAOAFQADkBVAA6AVgAOwFcADwBYAA9AWQAPgFoAD8BbABAAXAAQQF0AEIBeABDAXwARAGAAEUBhABGAYgARwGMAEgBkABJAZQASgGYAEsBnABMAaAATQGkAE4BqABPAawAUAGwAFEBtABSAbgAUwK8AFQCxABVAcwAVgHQAFcB1ABYAdgAWQHcAFoB4ABbAeQAXAHoAF0B7ABeAfAAXwD0AGAB9ABhAfgAYgH8AGMBAAFkAQQBZQEIAWYBDAFnARABaAEUAWkBGAFqARwBawEgAWwBJAFtASgBbgEsAW8BMAFwATQBcQE4AXIBPAFzAUABdAFEAXUBSAF2AUwBdwFQAXgBVAF5AVgBegFcAXsBYAF8AWQBfQFoAX4BbAF/AHABgABwAYEAcAGCAHABgwBwAYQAcAGFAHABhgBwAYcAcAGIAHABiQBwAYoAcAGLAHABjABwAY0AcAGOAHABjwBwAZAAcAGRAHABkgBwAZMAcAGUAHABlQBwAZYAcAGXAHABmABwAZkAcAGaAHABmwBwAZwAcAGdAHABngBwAZ8AcAGgAHABoQFwAaIAdAGjAHQBpAB0AaUAdAGmAHQBpwB0AagAdAGpAHQBqgB0AasBdAGsAHgBrQB4Aa4AeAGvAHgBsAB4AbEAeAGyAHgBswB4AbQAeAG1AHgBtgB4AbcAeAG4AXgBuQB8AboAfAG7AXwBvACAAb0AgAG+AIABvwGAAcABhAHBAYgBwgGMAcMAkAHEAZABxQCUAcYBlAHHAJgByAGYAckBnAHKAaABywGkAcwBqAHNAawBzgGwAc8BtAHQALgB0QC4AdIBuAHTAbwB1ALAAdUByAHWAcwB1wHQAdgA1AHZAdQB2gHYAdsB3AHcAeAB3QDkAd4A5AHfAOQB4AHkAeEB6AHiAewB4wDwAeQB8AHlAPQB5gH0AecB+AHoAfwB6QEAAuoBBALrAQgC7AEMAu0BEALuARQC7wEYAvAAHALxABwC8gEcAvMBIAL0ASQC9QAoAvYBKAL3ACwC+AAsAvkBLAL6ADAC+wEwAvwANAL9ADQC/gA0AiAACQAhAA4AIgAXACUAIAAnADEAKAA6ACkARwArAFQALABhAC0AagAuAHMALwB8ADAAiQAxAJYAMgCjADMAsAA0AL0ANQDKADYA1wA3AOQAOADxADkA/gA6AAsBOwAUATwAHQE9ACYBPgAvAT8AOAFAAEkBQQBOAUIAXwFDAGwBRAB5AUUAhgFGAJMBRwCgAUgArQFJALoBSgDDAUsA0AFMAN0BTQDqAU4A+wFPAAgCUAAVAlEAIgJSADMCUwBAAlIBKwdUAE0CUwFAB1UAWgJWAGcCVwB4AlgAjQJZAJ4CWgCvAlsAvAJcAMkCXQDWAl4A4wJgAOwCYQD1AmIAAgNjAA8DZAAcA2UAKQNmADYDZwBDA2gAUANpAF0DagBmA2sAcwNsAIADbQCNA24AmgNvAKcDcAC0A3EAwQNyAM4DcwDbA3QA6AN1APUDdgACBHcADwR4ABwEeQApBHoANgR7AEMEfABQBH0AWQR+AGYEoQBvBKsAeAS4AIUEuwCOBL8AmwTAAKwEwQC9BMIAzgTEAN8ExgDwBMgABQXJABYFygAnBcsAOAXMAEkFzQBWBc4AYwXPAHQF0gCFBdMAlgXUAKcFryUEANUAuAXWAMUF1wDSBdkA2wXaAOwF2wD9BdwADgbgAB8G4QAsBuIAOQbkAEYG5gBTBucAYAboAG0G6QB6BuoAhwbrAJQG7AChBu0ArgbuALsG7wDMBvIA3QbzAOoG9AD3BvYABAf5ABEH+wAeBwAAAAAAAAAQBgAAABADAQsBBQP/BQAAAwEBBQUHAAAABQ0BBQdzrUUIIULrnAEAAAACAQEFBAMAAAADDQEFBbS2bZtEAAAAAw0ABQSZbNu2FgAAAAYGAQkIDPMzDAMAAAACAwEOBB8AAAAEAQEKBg8AAAACAQEPBAMAAAAEDwADBIjMRERmJiIDBQsBBQdu77333ns7AAMLAQUGvm3btgEAAAAFCwEFB25jzJgxZnwABQsBBQdub4wZxns7AAULAQUHxBhjxN4fYwAFCwEF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");
        var font1 = fonts_load_custom_font_with_data(fontData);
        var font2 = fonts_get_system_font(FONT_KEY_GOTHIC_18);
        var font3 = fonts_load_custom_font({height: 40, url:"https://github.com/pebble-examples/feature-custom-font/raw/master/resources/fonts/osp-din/OSP-DIN.ttf"});

        /* Font and colors */
        var FONT_SYSTEM_NAME=FONT_KEY_ROBOTO_BOLD_SUBSET_49;
        var FONT_NAME=null;
        var FONT_SIZE=40;
        var DEFAULT_BACKGROUND_COLOR=GColorBlack;
        //var DEFAULT_TIME_COLOR=GColorRed;
        var DEFAULT_TIME_COLOR=GColorWhite;
        /* TODO custom font support */

        /* Time */
        var CLOCK_POS=GRect(0, 52, 144, 168);
        var TIME_ALIGN=GTextAlignmentCenter;
        var time_str="22:55";

        /* Date */
        var NO_DATE=false;  // if true, do NOT show date
        var FONT_DATE_SYSTEM_NAME=FONT_KEY_GOTHIC_18_BOLD;
        var DATE_POS=GRect(0, 140, 144, 168);
        var DATE_ALIGN=GTextAlignmentRight;
        var DATE_FMT_STR="%a, %d %b"
        var date_str="Thu, 20 Aug";

        /* Bluetooth */
        var FONT_BT_SYSTEM_NAME=FONT_KEY_GOTHIC_18;
        var BT_ALIGN=GTextAlignmentCenter;
        var BT_POS=GRect(0, 120, 144, 168);
        var BT_DISCONNECT_IMAGE_GRECT=GRect(0, 120, 144, 168);
        var BLUETOOTH_DISCONNECTED_STR="BT Disconnected";

        /* Battery */
        var NO_BATTERY=false;  // if true, do NOT show battery
        var FONT_BAT_SYSTEM_NAME=FONT_KEY_GOTHIC_18;
        var BAT_POS=GRect(0, 140, 144, 168);
        var BAT_ALIGN=GTextAlignmentLeft;
        var battery_level = 100;
        var BAT_FMT_STR="Bat: %d%%";
        var battery_str="Bat: 100%";
        var DRAW_BATTERY=true;
        var DRAW_SMALL_BATTERY=false;


        /* Health */
        var USE_HEALTH=false;
        var HEALTH_POS=GRect(0, 40, 144, 168);
        var HEALTH_ALIGN=GTextAlignmentCenter;
        var health_steps_str="123456 steps today";

        /* Bitmap logo */
        var BG_IMAGE=null;
        var IMAGE_RES_X=0;
        var IMAGE_RES_Y=0;
        var BG_IMAGE_GRECT=GRect(0, 0, 144, 168);  // Full rectangle

        /* customizations can go here START */

        ///*
        // Stormstrooper https://github.com/clach04/watchface_storm_trooper
        // https://github.com/clach04/watchface_storm_trooper/blob/vector_opaque/src/watch_config.h
        // Almost a copy/paste from watch_config.h with #define removed and assignment added
        BG_IMAGE='https://raw.githubusercontent.com/clach04/watchface_storm_trooper/vector_opaque/resources/images/storm_trooper.png';
        IMAGE_RES_X=125
        IMAGE_RES_Y=132
        BG_IMAGE_GRECT=GRect(Math.floor((144 - IMAGE_RES_X) / 2), 0,  IMAGE_RES_X, IMAGE_RES_Y)

        BAT_FMT_STR="%d%%"
        DATE_FMT_STR="%a\n%b\n%d"

        CLOCK_POS=GRect(0, 118, 144, 168) // bottom of screen for FONT_KEY_ROBOTO_BOLD_SUBSET_49 with one pixel border on bottom
        BT_DISCONNECT_IMAGE_GRECT=GRect(144 - 20, 168 - (2 * 30 + 4), 20, 30)
        BT_POS=GRect(0, 120, 144, 168)
        DATE_POS=GRect(0, 0, 144, 168)

        DRAW_BATTERY=false;
        DRAW_SMALL_BATTERY=false;
        BAT_POS=GRect(0, 0, 144, 168)
        DRAW_BATTERY=true;
        DRAW_SMALL_BATTERY=false;
        BAT_POS=GRect(5, 5, 144, 168)
        //*/

        /*
        // CapNion https://github.com/clach04/watchface_CapNion/blob/master/src/watch_config.h
        // Almost a copy/paste from watch_config.h with #define removed and assignment added
        BG_IMAGE='https://raw.githubusercontent.com/clach04/watchface_CapNion/master/resources/images/capnion.png';
        FONT_SYSTEM_NAME=FONT_KEY_BITHAM_42_BOLD
        BLUETOOTH_DISCONNECTED_STR="No BT"
        BAT_FMT_STR="Bat:\n%d%%"
        DATE_FMT_STR="%a\n%d %b"

        BT_ALIGN=GTextAlignmentRight
        BAT_ALIGN=GTextAlignmentRight
        TIME_ALIGN=GTextAlignmentRight

        DEFAULT_TIME_COLOR=GColorBlack
        DEFAULT_BACKGROUND_COLOR=GColorWhite

        var RHS_OFFSET=3
        CLOCK_POS=GRect(0, -8, 144 - RHS_OFFSET, 168)
        BT_POS=GRect(0, 40, 144, 168)
        DATE_POS=GRect(0, 65, 144 - RHS_OFFSET, 168)
        BAT_POS=GRect(0, 125, 144 - RHS_OFFSET, 168)
        */

        /*
        // JupiterMassXen
        // https://github.com/clach04/watchface_JupiterMass/blob/master/src/watch_config.h
        BG_IMAGE='https://raw.githubusercontent.com/clach04/watchface_JupiterMass/master/resources/images/n7logo~color.png'
        FONT_NAME='https://github.com/clach04/watchface_JupiterMass/raw/master/resources/fonts/ISL_Jupiter_Alphabot_Xen.ttf'
        FONT_SIZE=50 // Should be 75 - see https://github.com/pebble/rockyjs/issues/72
        CLOCK_POS=GRect(0, 40, 144, 168)
        BT_POS=GRect(0, 120, 144, 168)
        DATE_POS=GRect(0, 140, 144, 168)
        BAT_POS=GRect(0, 140, 144, 168)
        BAT_POS=GRect(5, 150, 144, 168)
        */
        /* customizations can go here END */

        var time_color=DEFAULT_TIME_COLOR;
        var background_color=DEFAULT_BACKGROUND_COLOR;

        if (BG_IMAGE)
        {
            if (IMAGE_RES_X==0)
            {
                var js_image=new Image;
                js_image.src=BG_IMAGE;
                // onload?
                IMAGE_RES_X=js_image.width;
                IMAGE_RES_Y=js_image.height;
            }
            var background_bitmap=gbitmap_create(BG_IMAGE);
        }
        else
        {
            var background_bitmap=null;
        }
        if (FONT_NAME)
        {
            if (FONT_SIZE > 50)
            {
                alert('FONT_SIZE ' + FONT_SIZE.toString() + ' maybe too large, see https://github.com/pebble/rockyjs/issues/72');
            }
            var time_font=fonts_load_custom_font({height: FONT_SIZE, url:FONT_NAME});
        }
        else
        {
            var time_font=fonts_get_system_font(FONT_SYSTEM_NAME);
        }
        var font_date=fonts_get_system_font(FONT_DATE_SYSTEM_NAME);
        var font_bt=fonts_get_system_font(FONT_BT_SYSTEM_NAME);
        var font_bat=fonts_get_system_font(FONT_BAT_SYSTEM_NAME);


var template_vars = {
    FONT_SYSTEM_NAME: FONT_SYSTEM_NAME,
    FONT_NAME: FONT_NAME,
    FONT_SIZE: FONT_SIZE,
    DEFAULT_BACKGROUND_COLOR: peb_color_dict[DEFAULT_BACKGROUND_COLOR],
    DEFAULT_TIME_COLOR: peb_color_dict[DEFAULT_TIME_COLOR],

    CLOCK_POS: CLOCK_POS,
    TIME_ALIGN: TIME_ALIGN,

    BG_IMAGE: BG_IMAGE,
    IMAGE_RES_X: IMAGE_RES_X,
    IMAGE_RES_Y: IMAGE_RES_Y,
    BG_IMAGE_GRECT: BG_IMAGE_GRECT,

    NO_DATE: NO_DATE,
    FONT_DATE_SYSTEM_NAME: FONT_DATE_SYSTEM_NAME,
    DATE_ALIGN: DATE_ALIGN,
    DATE_POS: DATE_POS,
    DATE_FMT_STR: DATE_FMT_STR.replace(/\n/g, '\\n'),

    NO_BATTERY: NO_BATTERY,
    FONT_BAT_SYSTEM_NAME: FONT_BAT_SYSTEM_NAME,
    BAT_ALIGN: BAT_ALIGN,
    BAT_POS: BAT_POS,
    BAT_FMT_STR: BAT_FMT_STR,
    DRAW_BATTERY: DRAW_BATTERY,
    DRAW_SMALL_BATTERY: DRAW_SMALL_BATTERY,

    BT_POS: BT_POS,
    BT_DISCONNECT_IMAGE_GRECT: BT_DISCONNECT_IMAGE_GRECT,
    FONT_BT_SYSTEM_NAME: FONT_BT_SYSTEM_NAME,
    BT_ALIGN: BT_ALIGN,
    BLUETOOTH_DISCONNECTED_STR: BLUETOOTH_DISCONNECTED_STR,

    USE_HEALTH: USE_HEALTH,
    HEALTH_POS: HEALTH_POS,
    HEALTH_ALIGN: HEALTH_ALIGN
};
	//var template = "<code>GRect(0, 52, 144, 168) == GRect({{a}}, {{b}}, {{c}}, {{d}})<code>";
    var template = $('#template').html();
	var html = Mustache.to_html(template, template_vars);
	$('#sampleArea').html(html);


        var value = 0;
        rocky.update_proc = function (ctx, bounds) {
            var current_datetime = new Date();

            /* text_layer_create(), etc. as of early Feb 2016 not yet implemented */
            /* Rectablge (Basalt)  NOT Round */


            graphics_context_set_fill_color(ctx, background_color);
            graphics_fill_rect(ctx, bounds, 0, GCornerNone);  // Fill background color, as if text background was set
            graphics_context_set_text_color(ctx, time_color);

            if (background_bitmap !== null)
            {
                // this file might not load successfully, draw a placeholder beneath it
                if (background_bitmap.status != 'loaded')
                {
                    graphics_draw_rect(ctx, BG_IMAGE_GRECT);
                }
                else
                {
                    graphics_draw_bitmap_in_rect(ctx, background_bitmap, BG_IMAGE_GRECT);
                }
            }

            if (USE_HEALTH)
            {
                graphics_draw_text(ctx, health_steps_str, font_date, HEALTH_POS, 0, HEALTH_ALIGN);
            }
            if (!NO_BATTERY)
            {
                if (!DRAW_BATTERY)
                {
                    /* text */
                    battery_str = sprintf(BAT_FMT_STR, battery_level);
                    graphics_draw_text(ctx, battery_str, font_bat, BAT_POS, 0, BAT_ALIGN);
                }
                else
                {
                    /* gfx */
                    battery_level = 100;
                    //battery_level = 20;
                    //battery_level = 10;
                    pos_y = pos_x = 100;
                    pos_y = BAT_POS.y;
                    pos_x = BAT_POS.x;
                    colour = GColorGreen;
                    colour = GColorWhite;
                    graphics_context_set_fill_color(ctx, colour);
                    graphics_context_set_stroke_color(ctx, colour);

                    if (DRAW_SMALL_BATTERY)
                    {
                        battery_path_info = gpath_create([[0,6],[0,0],[10,0],[10,2],[11,2],[11,4],[10,4],[10,6],[0,6],[1,5],[9,5],[9,1],[1,1],[1,5]]);
                    }
                    else
                    {
                        battery_path_info = gpath_create([[0,10],[0,0],[20,0],[20,4],[22,4],[22,8],[20,8],[20,12],[0,12],[0,10],[2,10],[18,10],[18,2],[2,2],[2,10]]);
                    }
                    gpath_move_to(battery_path_info, [pos_x, pos_y]);
                    gpath_draw_outline(ctx, battery_path_info);
                    gpath_draw_filled(ctx, battery_path_info);
                    //gpath_draw_outline_open(ctx, battery_path_info);

                    // Debug
                    //colour = GColorRed; graphics_context_set_fill_color(ctx, colour); graphics_context_set_stroke_color(ctx, colour);

                    if (DRAW_SMALL_BATTERY)
                    {
                        graphics_fill_rect(ctx, GRect(pos_x + 2, pos_y + 2, Math.floor(battery_level * 7 / 100), 3), 0, 0);
                    }
                    else
                    {
                        graphics_fill_rect(ctx, GRect(pos_x + 3, pos_y + 3, Math.floor(battery_level * 15 / 100), 7), 0, 0);
                    }
                }
            }
            
            // If use real time
            //time_str = _format('', []);
            time_min_str = _format('{0}', [current_datetime.getMinutes()]);
            if (time_min_str.length == 1)
            {
                time_min_str = "0" + time_min_str;
            }
            time_str = _format('{0}:{1}', [current_datetime.getHours(), time_min_str]);
            // FIXME / TODO Add 24 hour option
            // FIXME / TODO Add DEBUG_TIME and DEBUG_TIME_SCREENSHOT which cycles through a list of predefined times.
            // Allows placement to be tested (e.g. custom fonts, width check, etc.)

            if (!NO_DATE)
            {
                date_str = strftime(DATE_FMT_STR, current_datetime);
                graphics_draw_text(ctx, date_str, font_date, DATE_POS, 0, DATE_ALIGN);
            }
            graphics_draw_text(ctx, BLUETOOTH_DISCONNECTED_STR, font_bt, BT_POS, 0, BT_ALIGN);
            graphics_draw_text(ctx, time_str, time_font, CLOCK_POS, 0, TIME_ALIGN);

            // draw mask, Aplite/Basalt screen is not a perfect rectangle due to bevel/surround
            // Based on C code from https://www.reddit.com/r/pebbledevelopers/comments/3pwsuv/function_to_cut_the_corners_corners_off_in_the/
            {
                var width = 4;
                var inc = 2;
                graphics_context_set_stroke_color(ctx, GColorWhite);     // Corner Color
                for(var y = 0; y < 6; ++y)
                {
                    for(var x = 0; x < (width / 4); ++x)
                    {
                        graphics_draw_pixel(ctx, GPoint(      x,   5 - y));  //  Upper Left  Corner
                        graphics_draw_pixel(ctx, GPoint(      x, 162 + y));  // Bottom Left  Corner
                        graphics_draw_pixel(ctx, GPoint(143 - x,   5 - y));  //  Upper Right Corner
                        graphics_draw_pixel(ctx, GPoint(143 - x, 162 + y));  // Bottom Right Corner
                    }
                    width += inc++;
                }
            }
        };

        setInterval(function () {rocky.mark_dirty();}, 1000);  // Update once per sec

    })();
</script>
</html>
